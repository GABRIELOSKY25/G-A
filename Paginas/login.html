<!--Version de HTML-->
<!DOCTYPE html>
<!--Inicio de la pagiona web-->
<html lang="es">

<head>
    <meta charset = "UTF-8">
    <meta name = "viewport" content = "width=device-width, initial-scale=1.0">
    <!--Titutlo de Navegacion-->
    <title> Registro </title> 
    <!-- Logo de Navegacion -->
    <link rel = "icon" href = "../Logo_Principal.ico" type = "image/x-icon">
    <!-- Enlaces a hojas de estilo -->
    <link rel = "stylesheet" href = "../CSS/login.css">
    <script src = "https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>

<!--Contenido de la Pagina-->
<body>
    <!--Menu de navegacion-->
    <header>
        <!--Contenido-->
        <div class = "menu_navegacion">
            <div class = "contenedor">
                <div class = "logo">
                    <!--Ruta relativa-->
                    <a href = "../index.html">
                        <!--Ruta de imagen // src = ruta // alt = nombre // style = (width = ancho // height = alto)-->
                        <img src = "../Logo_Principal.png" alt = "G&A" style = "width: 60px; height: auto;">
                    </a>
                </div>

                <nav>
                    <!--Lista no ordenada-->
                    <ul>
                        <li><a href = "../index.html"> Inicio </a></li>
                        <li><a href = "catalogo.html"> Catalogo </a></li>
                        <li><a href = "oferta.html"> Ofertas </a></li>
                        <li><a href = "ubicacion.html"> Ubicacion </a></li>
                        <li><a href = "carrito.html"> Carrito </a></li>
                        <li><a href = "cuenta.php"> Cuenta </a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <main>
        <!--Seccion Registro-->
        <section class="registro">
            <div class="contenedor">
                <div class="registro_contenedor">
                    <!-- AQU√ç EST√Å EL CAMBIO: Envolver el form con cuenta_nueva -->
                    <div class="cuenta_nueva">
                        <h1>Crear Cuenta</h1>
                        <p>√önete a nuestra comunidad de gamers</p>
                        
                        <form class="formulario"action="http://localhost/proyecto/procesar_login.php"method="POST"@submit.prevent="validarFormulario($event)">
                            <!--Informacion personal-->
                            <div class="formulario_personal">
                                <div class="formulario_grupo">
                                    <label for="nombre_completo"> Nombre Completo * </label>
                                    <input type="text" id="nombre_completo" name="nombre_completo"v-model="formData.nombre_completo":class="getFieldClass('nombre_completo')"required placeholder="Nombre">
                                    <span class="error-message" v-if="errores.nombre_completo">{{ errores.nombre_completo }}</span>
                                </div>

                                <div class="formulario_grupo">
                                    <label for="telefono"> Tel√©fono * </label>
                                    <input type="tel" id="telefono" name="telefono"v-model="formData.telefono"@input="validarTelefono":class="getFieldClass('telefono')"required placeholder="Telefono">

                                    <span class="error-message" v-if="errores.telefono">{{ errores.telefono }}</span>
                                </div>
                            </div>

                            <div class="formulario_personal">
                                <div class="formulario_grupo">
                                    <label for="fecha_nacimiento"> Fecha de Nacimiento * </label>
                                    <input type="date" id="fecha_nacimiento" name="fecha_nacimiento"v-model="formData.fecha_nacimiento"@change="validarEdad":class="getFieldClass('fecha_nacimiento')"required>

                                    <span class="error-message" v-if="errores.fecha_nacimiento">{{ errores.fecha_nacimiento }}</span>
                                </div>

                                <div class="formulario_grupo">
                                    <label for="genero"> G√©nero </label>
                                    <select id="genero" name="genero" v-model="formData.genero">
                                        <option value=""> Seleccionar </option>
                                        <option value="Hombre"> Hombre </option>
                                        <option value="Mujer"> Mujer </option>
                                        <option value="Otro"> Otro </option>
                                        <option value="Prefiero no decir"> Prefiero no decir </option>
                                    </select>
                                </div>
                            </div>

                            <!--Informacion de cuenta-->
                            <div class="formulario_grupo">
                                <label for="email"> Correo Electr√≥nico * </label>
                                <input type="email" id="email" name="email"v-model="formData.email"@input="validarEmail":class="getFieldClass('email')"required placeholder="tu@email.com">

                                <span class="error-message" v-if="errores.email">{{ errores.email }}</span>
                            </div>

                            <div class="formulario_personal">
                                <div class="formulario_grupo">
                                    <label for="password"> Contrase√±a * </label>
                                    <input type="password" id="password" name="password"v-model="formData.password"@input="validarPassword":class="getFieldClass('password')"required placeholder="Crea una contrase√±a">

                                    <span class="error-message" v-if="errores.password">{{ errores.password }}</span>
                                </div>

                                <div class="formulario_grupo">
                                    <label for="confirmar_password"> Confirmar Contrase√±a * </label>
                                    <input type="password" id="confirmar_password" name="confirmar_password"v-model="formData.confirmar_password"@input="validarConfirmacionPassword":class="getFieldClass('confirmar_password')"required placeholder="Confirmar contrase√±a">

                                    <span class="error-message" v-if="errores.confirmar_password">{{ errores.confirmar_password }}</span>
                                </div>
                            </div>

                            <!-- T√©rminos y Opciones -->
                            <div class="formulario_opciones">
                                <!-- Suscripci√≥n -->
                                <label class="contenedor_check">
                                    <input type="checkbox" id="suscribirse" v-model="formData.suscribirse" checked>
                                    <span class="checkmark"></span>
                                    <span class="checkbox_texto"> Recibir ofertas y novedades por correo </span>
                                </label>
                                
                                <!-- Aceptaci√≥n de t√©rminos -->
                                <label class="formulario_terminos">
                                    <input type="checkbox" id="terminos" v-model="formData.terminos" required>
                                    <span class="checkmark"></span>
                                    <span class="checkbox_texto"> Acepto los <a href="terminos.html" class="link"> t√©rminos y condiciones </a> </span>
                                </label>
                                <span class="error-message" v-if="errores.terminos">{{ errores.terminos }}</span>
                            </div>
                            
                            <!-- Bot√≥n principal de registro -->
                            <button type="submit" class="boton_crear" :disabled="!formularioValido"> Crear Cuenta </button>
                        </form>
                    </div>
                    
                    <!-- Beneficios de registrarse -->
                    <div class="beneficios">
                        <h2> Ventajas de Registrarte </h2>
                        <ul>
                            <li> üéÆ Ofertas exclusivas para miembros </li>
                            <li> üì¶ Historial completo de compras </li>
                            <li> üéØ Recomendaciones personalizadas </li>
                            <li> ‚≠ê Acceso a preventas y lanzamientos </li>
                            <li> üõ°Ô∏è Soporte prioritario 24/7 </li>
                            <li> üèÜ Puntos de recompensa por compras </li>
                            <li> üë• Comunidad de gamers </li>
                            <li> üí¨ Foros y discusiones exclusivas </li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!--Pie de pagina-->
    <footer>
        <div class = "contenedor">
            <div class = "espacio_footer">
                <!--General-->
                <div class = "seccion_footer">
                    <h3>G&A</h3>
                    <p> Tu plataforma de videojuegos de confianza </p>
                </div>

                <!--Enlaces rapidos-->
                <div class = "seccion_footer">
                    <h4> Descurbir </h4>
                    <ul>
                        <li><a href = "../index.html"> Inicio </a></li>
                        <li><a href = "./catalogo.html"> Catalogo </a></li>
                        <li><a href = "./oferta.html"> Ofertas </a></li>
                        <li><a href = "./ubicacion.html"> Ubicaci√≥n </a></li>
                        <li><a href = "./carrito.html"> Carrito </a></li>
                    </ul>
                </div>

                <!--Soporte-->
                <div class = "seccion_footer">
                    <h4> Soporte </h4>
                    <ul>
                        <li><a href = "./soporte.html"> Soporte </a></li>    
                        <li><a href = "./cuenta.php"> Cuenta </a></li>
                    </ul>
                </div> 

                <!--Legal-->
                <div class = "seccion_footer">
                    <h4> Valores </h4>
                    <ul>
                        <li><a href = "./terminos.html"> T√©rminos y condiciones </a></li>
                        <li><a href = "./privacidad.html"> Pol√≠tica de privacidad </a></li>
                    </ul>
                </div> 

                <!--Redes sociales-->
                <div class = "seccion_footer">
                    <h4> Siguenos </h4>
                    <div class = "link_social">
                        <ul>
                            <li> <a href = "" target = "_blank"> <img src = "../Imagenes/Redes Sociales/facebook.jpg" alt = "Facebook" > </a> </li>
                            <li> <a href = "" target = "_blank"> <img src = "../Imagenes/Redes Sociales/x.jpg" alt = "X"> </a> </li>
                            <li> <a href = "" target = "_blank"> <img src = "../Imagenes/Redes Sociales/instagram.jpg" alt = "Instagram"> </a> </li>
                        </ul>
                    </div>
                </div> 
            </div>
            
            <!-- Derechos reservados -->
            <div class = "derechos">
                <p> &copy; 2025 G&A. Todos los derechos reservados </p>
            </div>
        </div>
    </footer>
    
    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    formData: {
                        nombre_completo: '',
                        telefono: '',
                        fecha_nacimiento: '',
                        genero: '',
                        email: '',
                        password: '',
                        confirmar_password: '',
                        suscribirse: true,
                        terminos: false
                    },
                    errores: {
                        nombre_completo: '',
                        telefono: '',
                        fecha_nacimiento: '',
                        email: '',
                        password: '',
                        confirmar_password: '',
                        terminos: ''
                    }
                }
            },
            computed: {
                formularioValido() {
                    return Object.values(this.errores).every(error => error === '') && 
                        this.formData.terminos &&
                        Object.values(this.formData).every(field => {
                            if (field === this.formData.genero || field === this.formData.suscribirse) return true;
                            return field !== '';
                        });
                }
            },
            methods: {
                validarTelefono() {
                    const telefono = this.formData.telefono.replace(/\D/g, '');
                    this.formData.telefono = telefono;
                    
                    if (telefono.length !== 10) {
                        this.errores.telefono = 'El tel√©fono debe tener exactamente 10 d√≠gitos';
                    } else {
                        this.errores.telefono = '';
                    }
                },
                
                validarEdad() {
                    if (!this.formData.fecha_nacimiento) {
                        this.errores.fecha_nacimiento = '';
                        return;
                    }
                    
                    const fechaNacimiento = new Date(this.formData.fecha_nacimiento);
                    const hoy = new Date();
                    let edad = hoy.getFullYear() - fechaNacimiento.getFullYear();
                    const mes = hoy.getMonth() - fechaNacimiento.getMonth();
                    
                    if (mes < 0 || (mes === 0 && hoy.getDate() < fechaNacimiento.getDate())) {
                        edad--;
                    }
                    
                    if (edad < 18) {
                        this.errores.fecha_nacimiento = 'Debes tener al menos 18 a√±os para registrarte';
                    } else {
                        this.errores.fecha_nacimiento = '';
                    }
                },
                
                validarEmail() {
                    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                    if (!emailRegex.test(this.formData.email)) {
                        this.errores.email = 'Por favor ingresa un correo electr√≥nico v√°lido';
                    } else {
                        this.errores.email = '';
                    }
                },
                
                validarPassword() {
                    const password = this.formData.password;
                    const tieneMayuscula = /[A-Z]/.test(password);
                    const tieneNumero = /\d/.test(password);
                    const tieneSimbolo = /[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(password);
                    
                    if (password.length < 8) {
                        this.errores.password = 'La contrase√±a debe tener al menos 8 caracteres';
                    } else if (!tieneMayuscula) {
                        this.errores.password = 'La contrase√±a debe incluir al menos una may√∫scula';
                    } else if (!tieneNumero) {
                        this.errores.password = 'La contrase√±a debe incluir al menos un n√∫mero';
                    } else if (!tieneSimbolo) {
                        this.errores.password = 'La contrase√±a debe incluir al menos un s√≠mbolo';
                    } else {
                        this.errores.password = '';
                    }
                    
                    // Validar tambi√©n la confirmaci√≥n si ya tiene valor
                    if (this.formData.confirmar_password) {
                        this.validarConfirmacionPassword();
                    }
                },
                
                validarConfirmacionPassword() {
                    if (this.formData.password !== this.formData.confirmar_password) {
                        this.errores.confirmar_password = 'Las contrase√±as no coinciden';
                    } else {
                        this.errores.confirmar_password = '';
                    }
                },
                
                validarFormulario(event) {
                    // Validar todos los campos antes de enviar
                    this.validarTelefono();
                    this.validarEdad();
                    if (this.formData.email) this.validarEmail();
                    if (this.formData.password) this.validarPassword();
                    if (this.formData.confirmar_password) this.validarConfirmacionPassword();

                    // Validar t√©rminos
                    if (!this.formData.terminos) {
                        this.errores.terminos = 'Debes aceptar los t√©rminos y condiciones';
                    } else {
                        this.errores.terminos = '';
                    }

                    // Validar campos vac√≠os
                    if (!this.formData.nombre_completo.trim()) {
                        this.errores.nombre_completo = 'El nombre completo es obligatorio';
                    } else {
                        this.errores.nombre_completo = '';
                    }

                    // Si el formulario es v√°lido, enviar al PHP
                    if (this.formularioValido) {
                        event.target.submit();   // ‚¨ÖÔ∏è aqu√≠ se manda al procesar_login.php
                    }
                },

                
                // M√©todo para obtener clase CSS seg√∫n validaci√≥n
                getFieldClass(fieldName) {
                    if (this.errores[fieldName]) {
                        return 'error';
                    }
                    if (this.formData[fieldName] && !this.errores[fieldName]) {
                        return 'valid';
                    }
                    return '';
                }
            }
        }).mount('main');
    </script>

    <!-- Archivo JavaScript -->
    <script src = "../JavaScript/carrito.js"></script>
</body>
</html>
